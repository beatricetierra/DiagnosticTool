#!/bin/sh

# Make directory 
if [[ ! -d "/home/rxm/kvctlogs" ]]
then
        echo "Directory doesn't exist. Creating now"
        mkdir /home/rxm/kvctlogs
        echo "Directory created"
else	
       	echo "Directory already exists. Adding files to directory"
	    rm -r /home/rxm/kvctlogs
	    mkdir /home/rxm/kvctlogs
fi

# Get all log files with chosen date
d=
n=0
until [ "$d" = "$2" ]
do  
	d=$(date -d "$1 + $n days" "+%Y-%m-%d")
	mkdir /home/rxm/kvctlogs/$d
	cp -r /home/rxm/log/archive/$d/*-pet_recon-* /home/rxm/kvctlogs/$d
	scp -r 192.168.10.106:/home/rxm/log/archive/$d/*-kvct-* /home/rxm/kvctlogs/$d
	scp -r 192.168.10.110:/home/rxm/log/archive/$d/*-sysnode-* /home/rxm/kvctlogs/$d
	((n++))
done

echo "Finding Interlocks"
python ./kvct/GetKvctInterlocks.py /home/rxm/kvctlogs $1 $2
